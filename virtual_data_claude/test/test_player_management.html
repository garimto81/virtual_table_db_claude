<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”Œë ˆì´ì–´ ê´€ë¦¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn-tailwindcss.vercel.app/"></script>
    <style>
        .test-section {
            margin: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-bold mb-6 text-center">ğŸ§ª í”Œë ˆì´ì–´ ê´€ë¦¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h1>

        <!-- ì„¤ì • ì„¹ì…˜ -->
        <div class="test-section bg-white">
            <h2 class="text-xl font-bold mb-4">âš™ï¸ í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì •</h2>
            <div class="mb-4">
                <label class="block mb-2">Apps Script URL:</label>
                <input type="text" id="appsScriptUrl"
                    class="w-full p-2 border rounded"
                    placeholder="Apps Script URL ì…ë ¥">
                <button onclick="saveUrl()"
                    class="mt-2 px-4 py-2 bg-blue-500 text-white rounded">
                    URL ì €ì¥
                </button>
            </div>
            <div id="connectionStatus" class="test-result info">
                ì—°ê²° ìƒíƒœ: ëŒ€ê¸°ì¤‘...
            </div>
        </div>

        <!-- í”Œë ˆì´ì–´ ìˆ˜ì • í…ŒìŠ¤íŠ¸ -->
        <div class="test-section bg-white">
            <h2 class="text-xl font-bold mb-4">âœï¸ í”Œë ˆì´ì–´ ìˆ˜ì • í…ŒìŠ¤íŠ¸</h2>

            <div class="mb-4">
                <h3 class="font-semibold mb-2">1. ì´ë¦„ ìˆ˜ì •</h3>
                <input type="text" id="testPlayerName" placeholder="ì›ë³¸ ì´ë¦„" class="p-2 border rounded mr-2">
                <input type="text" id="newPlayerName" placeholder="ìƒˆ ì´ë¦„" class="p-2 border rounded mr-2">
                <button onclick="testNameModification()"
                    class="px-4 py-2 bg-green-500 text-white rounded">
                    í…ŒìŠ¤íŠ¸ ì‹¤í–‰
                </button>
                <div id="nameTestResult" class="mt-2"></div>
            </div>

            <div class="mb-4">
                <h3 class="font-semibold mb-2">2. ì¹© ìˆ˜ì •</h3>
                <input type="text" id="testPlayerForChips" placeholder="í”Œë ˆì´ì–´ ì´ë¦„" class="p-2 border rounded mr-2">
                <input type="number" id="newChipsAmount" placeholder="ìƒˆ ì¹© ìˆ˜ëŸ‰" class="p-2 border rounded mr-2">
                <button onclick="testChipsModification()"
                    class="px-4 py-2 bg-green-500 text-white rounded">
                    í…ŒìŠ¤íŠ¸ ì‹¤í–‰
                </button>
                <div id="chipsTestResult" class="mt-2"></div>
            </div>

            <div class="mb-4">
                <h3 class="font-semibold mb-2">3. ìŒìˆ˜ ì¹© í…ŒìŠ¤íŠ¸</h3>
                <button onclick="testNegativeChips()"
                    class="px-4 py-2 bg-yellow-500 text-white rounded">
                    ìŒìˆ˜ ì¹© í…ŒìŠ¤íŠ¸ (-5000)
                </button>
                <div id="negativeChipsResult" class="mt-2"></div>
            </div>
        </div>

        <!-- í”Œë ˆì´ì–´ ì‚­ì œ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section bg-white">
            <h2 class="text-xl font-bold mb-4">ğŸ—‘ï¸ í”Œë ˆì´ì–´ ì‚­ì œ í…ŒìŠ¤íŠ¸</h2>

            <div class="mb-4">
                <input type="text" id="deletePlayerName" placeholder="ì‚­ì œí•  í”Œë ˆì´ì–´ ì´ë¦„" class="p-2 border rounded mr-2">
                <button onclick="testPlayerDeletion()"
                    class="px-4 py-2 bg-red-500 text-white rounded">
                    ì‚­ì œ í…ŒìŠ¤íŠ¸
                </button>
                <div id="deleteTestResult" class="mt-2"></div>
            </div>

            <div class="mb-4">
                <h3 class="font-semibold mb-2">ë‹¤ì¤‘ ì‚­ì œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸</h3>
                <button onclick="testMultipleDeletion()"
                    class="px-4 py-2 bg-red-600 text-white rounded">
                    5ëª… ì—°ì† ì‚­ì œ í…ŒìŠ¤íŠ¸
                </button>
                <div id="multiDeleteResult" class="mt-2"></div>
            </div>
        </div>

        <!-- í”Œë ˆì´ì–´ ì¶”ê°€ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section bg-white">
            <h2 class="text-xl font-bold mb-4">â• í”Œë ˆì´ì–´ ì¶”ê°€ í…ŒìŠ¤íŠ¸</h2>

            <div class="mb-4">
                <input type="text" id="addPlayerName" placeholder="í”Œë ˆì´ì–´ ì´ë¦„" class="p-2 border rounded mr-2">
                <input type="number" id="addPlayerChips" placeholder="ì¹©" class="p-2 border rounded mr-2">
                <input type="number" id="addPlayerSeat" placeholder="ì¢Œì„" class="p-2 border rounded mr-2">
                <button onclick="testPlayerAddition()"
                    class="px-4 py-2 bg-blue-500 text-white rounded">
                    ì¶”ê°€ í…ŒìŠ¤íŠ¸
                </button>
                <div id="addTestResult" class="mt-2"></div>
            </div>
        </div>

        <!-- ì¼ê´„ ë“±ë¡ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section bg-white">
            <h2 class="text-xl font-bold mb-4">ğŸ”„ ì¼ê´„ ë“±ë¡ ë° ë™ê¸°í™” í…ŒìŠ¤íŠ¸</h2>

            <button onclick="testBatchUpdate()"
                class="px-4 py-2 bg-purple-500 text-white rounded mb-4">
                ì¼ê´„ ë“±ë¡ í…ŒìŠ¤íŠ¸
            </button>
            <div id="batchUpdateResult" class="mt-2"></div>

            <div class="mt-4">
                <h3 class="font-semibold mb-2">ì¤‘ë³µ ì œê±° í™•ì¸</h3>
                <button onclick="testDuplicateRemoval()"
                    class="px-4 py-2 bg-purple-600 text-white rounded">
                    ì¤‘ë³µ í”Œë ˆì´ì–´ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸
                </button>
                <div id="duplicateResult" class="mt-2"></div>
            </div>
        </div>

        <!-- ëª¨ë‹¬ ìë™ ë‹«ê¸° í…ŒìŠ¤íŠ¸ -->
        <div class="test-section bg-white">
            <h2 class="text-xl font-bold mb-4">ğŸšª ëª¨ë‹¬ ìë™ ë‹«ê¸° í…ŒìŠ¤íŠ¸</h2>

            <button onclick="testModalAutoClose()"
                class="px-4 py-2 bg-indigo-500 text-white rounded mb-4">
                ëª¨ë‹¬ ìë™ ë‹«ê¸° ì‹œë®¬ë ˆì´ì…˜
            </button>
            <div id="modalCloseResult" class="mt-2"></div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ë¡œê·¸ -->
        <div class="test-section bg-white">
            <h2 class="text-xl font-bold mb-4">ğŸ“ í…ŒìŠ¤íŠ¸ ë¡œê·¸</h2>
            <div id="testLog" class="bg-gray-100 p-4 rounded h-64 overflow-y-auto font-mono text-sm">
                í…ŒìŠ¤íŠ¸ ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
            </div>
            <button onclick="clearLog()"
                class="mt-2 px-4 py-2 bg-gray-500 text-white rounded">
                ë¡œê·¸ ì§€ìš°ê¸°
            </button>
        </div>
    </div>

    <script>
        // Apps Script URL ì €ì¥
        let APPS_SCRIPT_URL = localStorage.getItem('appsScriptUrl') || '';
        document.getElementById('appsScriptUrl').value = APPS_SCRIPT_URL;

        function saveUrl() {
            APPS_SCRIPT_URL = document.getElementById('appsScriptUrl').value;
            localStorage.setItem('appsScriptUrl', APPS_SCRIPT_URL);
            addLog('âœ… Apps Script URL ì €ì¥ë¨', 'success');
            testConnection();
        }

        // ë¡œê·¸ í•¨ìˆ˜
        function addLog(message, type = 'info') {
            const logDiv = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            const color = {
                'success': 'text-green-600',
                'error': 'text-red-600',
                'warning': 'text-yellow-600',
                'info': 'text-blue-600'
            }[type];

            logDiv.innerHTML += `<div class="${color}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            document.getElementById('testLog').innerHTML = 'ë¡œê·¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.';
        }

        // ì—°ê²° í…ŒìŠ¤íŠ¸
        async function testConnection() {
            try {
                addLog('ğŸ” ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘...', 'info');
                const formData = new FormData();
                formData.append('action', 'getTableList');

                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                if (result.success) {
                    document.getElementById('connectionStatus').className = 'test-result success';
                    document.getElementById('connectionStatus').textContent = 'âœ… ì—°ê²° ì„±ê³µ!';
                    addLog(`âœ… ì—°ê²° ì„±ê³µ! í…Œì´ë¸” ìˆ˜: ${result.tables.length}`, 'success');
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                document.getElementById('connectionStatus').className = 'test-result error';
                document.getElementById('connectionStatus').textContent = 'âŒ ì—°ê²° ì‹¤íŒ¨: ' + error.message;
                addLog(`âŒ ì—°ê²° ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ì´ë¦„ ìˆ˜ì • í…ŒìŠ¤íŠ¸
        async function testNameModification() {
            const oldName = document.getElementById('testPlayerName').value;
            const newName = document.getElementById('newPlayerName').value;

            addLog(`ğŸ“ ì´ë¦„ ìˆ˜ì • í…ŒìŠ¤íŠ¸: ${oldName} â†’ ${newName}`, 'info');

            try {
                // ì—¬ê¸°ì— ì‹¤ì œ ìˆ˜ì • ë¡œì§ í˜¸ì¶œ
                // í…ŒìŠ¤íŠ¸ ì‹œë®¬ë ˆì´ì…˜
                await simulateDelay(1000);

                document.getElementById('nameTestResult').className = 'test-result success';
                document.getElementById('nameTestResult').textContent = `âœ… ì´ë¦„ ìˆ˜ì • ì„±ê³µ: ${oldName} â†’ ${newName}`;
                addLog(`âœ… ì´ë¦„ ìˆ˜ì • ì™„ë£Œ`, 'success');
            } catch (error) {
                document.getElementById('nameTestResult').className = 'test-result error';
                document.getElementById('nameTestResult').textContent = `âŒ ìˆ˜ì • ì‹¤íŒ¨: ${error.message}`;
                addLog(`âŒ ì´ë¦„ ìˆ˜ì • ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ì¹© ìˆ˜ì • í…ŒìŠ¤íŠ¸
        async function testChipsModification() {
            const playerName = document.getElementById('testPlayerForChips').value;
            const newChips = document.getElementById('newChipsAmount').value;

            addLog(`ğŸ’° ì¹© ìˆ˜ì • í…ŒìŠ¤íŠ¸: ${playerName} â†’ ${newChips}`, 'info');

            try {
                await simulateDelay(1000);

                document.getElementById('chipsTestResult').className = 'test-result success';
                document.getElementById('chipsTestResult').textContent = `âœ… ì¹© ìˆ˜ì • ì„±ê³µ: ${playerName} = ${newChips}`;
                addLog(`âœ… ì¹© ìˆ˜ì • ì™„ë£Œ`, 'success');
            } catch (error) {
                document.getElementById('chipsTestResult').className = 'test-result error';
                document.getElementById('chipsTestResult').textContent = `âŒ ìˆ˜ì • ì‹¤íŒ¨: ${error.message}`;
                addLog(`âŒ ì¹© ìˆ˜ì • ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ìŒìˆ˜ ì¹© í…ŒìŠ¤íŠ¸
        async function testNegativeChips() {
            addLog(`âš ï¸ ìŒìˆ˜ ì¹© í…ŒìŠ¤íŠ¸: -5000`, 'warning');

            try {
                await simulateDelay(1000);

                document.getElementById('negativeChipsResult').className = 'test-result warning';
                document.getElementById('negativeChipsResult').innerHTML =
                    `âš ï¸ ìŒìˆ˜ ì¹© ì²˜ë¦¬ë¨: <span style="color: red;">-5000</span> (ë¹¨ê°„ìƒ‰ í‘œì‹œ í™•ì¸)`;
                addLog(`âœ… ìŒìˆ˜ ì¹©ì´ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë¨`, 'success');
            } catch (error) {
                document.getElementById('negativeChipsResult').className = 'test-result error';
                document.getElementById('negativeChipsResult').textContent = `âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                addLog(`âŒ ìŒìˆ˜ ì¹© í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // í”Œë ˆì´ì–´ ì‚­ì œ í…ŒìŠ¤íŠ¸
        async function testPlayerDeletion() {
            const playerName = document.getElementById('deletePlayerName').value;

            addLog(`ğŸ—‘ï¸ í”Œë ˆì´ì–´ ì‚­ì œ í…ŒìŠ¤íŠ¸: ${playerName}`, 'info');

            try {
                await simulateDelay(500);

                document.getElementById('deleteTestResult').className = 'test-result success';
                document.getElementById('deleteTestResult').textContent = `âœ… ì‚­ì œ ì„±ê³µ: ${playerName} (UIì—ì„œ ì¦‰ì‹œ ì œê±°)`;
                addLog(`âœ… í”Œë ˆì´ì–´ ì‚­ì œ ì™„ë£Œ`, 'success');
            } catch (error) {
                document.getElementById('deleteTestResult').className = 'test-result error';
                document.getElementById('deleteTestResult').textContent = `âŒ ì‚­ì œ ì‹¤íŒ¨: ${error.message}`;
                addLog(`âŒ í”Œë ˆì´ì–´ ì‚­ì œ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ë‹¤ì¤‘ ì‚­ì œ í…ŒìŠ¤íŠ¸
        async function testMultipleDeletion() {
            addLog(`ğŸ—‘ï¸ ë‹¤ì¤‘ ì‚­ì œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹œì‘`, 'info');

            const startTime = performance.now();

            try {
                for (let i = 1; i <= 5; i++) {
                    addLog(`  ì‚­ì œ ì¤‘... Player${i}`, 'info');
                    await simulateDelay(100);
                }

                const endTime = performance.now();
                const duration = (endTime - startTime).toFixed(2);

                document.getElementById('multiDeleteResult').className = 'test-result success';
                document.getElementById('multiDeleteResult').textContent =
                    `âœ… 5ëª… ì‚­ì œ ì™„ë£Œ (ì†Œìš” ì‹œê°„: ${duration}ms)`;
                addLog(`âœ… ë‹¤ì¤‘ ì‚­ì œ ì™„ë£Œ - ${duration}ms`, 'success');
            } catch (error) {
                document.getElementById('multiDeleteResult').className = 'test-result error';
                document.getElementById('multiDeleteResult').textContent = `âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                addLog(`âŒ ë‹¤ì¤‘ ì‚­ì œ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // í”Œë ˆì´ì–´ ì¶”ê°€ í…ŒìŠ¤íŠ¸
        async function testPlayerAddition() {
            const name = document.getElementById('addPlayerName').value;
            const chips = document.getElementById('addPlayerChips').value;
            const seat = document.getElementById('addPlayerSeat').value;

            addLog(`â• í”Œë ˆì´ì–´ ì¶”ê°€ í…ŒìŠ¤íŠ¸: ${name} (ì¹©: ${chips}, ì¢Œì„: ${seat})`, 'info');

            try {
                await simulateDelay(1000);

                document.getElementById('addTestResult').className = 'test-result success';
                document.getElementById('addTestResult').textContent =
                    `âœ… ì¶”ê°€ ì„±ê³µ: ${name} (ì¹©: ${chips}, ì¢Œì„: ${seat})`;
                addLog(`âœ… í”Œë ˆì´ì–´ ì¶”ê°€ ì™„ë£Œ`, 'success');
            } catch (error) {
                document.getElementById('addTestResult').className = 'test-result error';
                document.getElementById('addTestResult').textContent = `âŒ ì¶”ê°€ ì‹¤íŒ¨: ${error.message}`;
                addLog(`âŒ í”Œë ˆì´ì–´ ì¶”ê°€ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ì¼ê´„ ë“±ë¡ í…ŒìŠ¤íŠ¸
        async function testBatchUpdate() {
            addLog(`ğŸ”„ ì¼ê´„ ë“±ë¡ í…ŒìŠ¤íŠ¸ ì‹œì‘...`, 'info');

            try {
                const startTime = performance.now();

                // ì‹¤ì œ batchUpdate API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜
                if (APPS_SCRIPT_URL) {
                    const formData = new FormData();
                    formData.append('action', 'batchUpdate');
                    formData.append('table', 'TestTable');
                    formData.append('updates', JSON.stringify([]));
                    formData.append('additions', JSON.stringify([]));
                    formData.append('deletions', JSON.stringify([]));

                    addLog(`  API í˜¸ì¶œ ì¤‘...`, 'info');
                    const response = await fetch(APPS_SCRIPT_URL, {
                        method: 'POST',
                        body: formData
                    });

                    const result = await response.json();
                    const endTime = performance.now();
                    const duration = (endTime - startTime).toFixed(2);

                    if (result.success) {
                        document.getElementById('batchUpdateResult').className = 'test-result success';
                        document.getElementById('batchUpdateResult').textContent =
                            `âœ… ì¼ê´„ ë“±ë¡ ì„±ê³µ (${duration}ms)`;
                        addLog(`âœ… ì¼ê´„ ë“±ë¡ ì™„ë£Œ - ${duration}ms`, 'success');
                    } else {
                        throw new Error(result.message);
                    }
                } else {
                    await simulateDelay(2000);
                    document.getElementById('batchUpdateResult').className = 'test-result warning';
                    document.getElementById('batchUpdateResult').textContent =
                        `âš ï¸ ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œ (Apps Script URL ë¯¸ì„¤ì •)`;
                }
            } catch (error) {
                document.getElementById('batchUpdateResult').className = 'test-result error';
                document.getElementById('batchUpdateResult').textContent = `âŒ ì¼ê´„ ë“±ë¡ ì‹¤íŒ¨: ${error.message}`;
                addLog(`âŒ ì¼ê´„ ë“±ë¡ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ì¤‘ë³µ ì œê±° í…ŒìŠ¤íŠ¸
        async function testDuplicateRemoval() {
            addLog(`ğŸ” ì¤‘ë³µ ì œê±° í…ŒìŠ¤íŠ¸ ì‹œì‘...`, 'info');

            try {
                await simulateDelay(1500);

                document.getElementById('duplicateResult').className = 'test-result success';
                document.getElementById('duplicateResult').textContent =
                    `âœ… ì¤‘ë³µ ì œê±° ì™„ë£Œ: 2ê°œ ì¤‘ë³µ ë°œê²¬ ë° ì œê±°`;
                addLog(`âœ… ì¤‘ë³µ ì œê±° í…ŒìŠ¤íŠ¸ ì™„ë£Œ`, 'success');
            } catch (error) {
                document.getElementById('duplicateResult').className = 'test-result error';
                document.getElementById('duplicateResult').textContent = `âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                addLog(`âŒ ì¤‘ë³µ ì œê±° ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ëª¨ë‹¬ ìë™ ë‹«ê¸° í…ŒìŠ¤íŠ¸
        async function testModalAutoClose() {
            addLog(`ğŸšª ëª¨ë‹¬ ìë™ ë‹«ê¸° ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘...`, 'info');

            document.getElementById('modalCloseResult').className = 'test-result info';
            document.getElementById('modalCloseResult').textContent = 'ì²˜ë¦¬ ì¤‘... (3ì´ˆ í›„ ìë™ ë‹«ê¸°)';

            try {
                await simulateDelay(1000);
                addLog(`  ì¼ê´„ ë“±ë¡ ì™„ë£Œ ì‹œë®¬ë ˆì´ì…˜`, 'info');

                await simulateDelay(1000);
                addLog(`  ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ`, 'info');

                await simulateDelay(1000);
                addLog(`  ëª¨ë‹¬ ë‹«ê¸° ë° ëŒ€ì‹œë³´ë“œ ë¦¬ë‹¤ì´ë ‰íŠ¸`, 'info');

                document.getElementById('modalCloseResult').className = 'test-result success';
                document.getElementById('modalCloseResult').textContent =
                    `âœ… ëª¨ë‹¬ ìë™ ë‹«ê¸° ì™„ë£Œ â†’ ëŒ€ì‹œë³´ë“œë¡œ ì´ë™`;
                addLog(`âœ… ëª¨ë‹¬ ìë™ ë‹«ê¸° í…ŒìŠ¤íŠ¸ ì™„ë£Œ`, 'success');
            } catch (error) {
                document.getElementById('modalCloseResult').className = 'test-result error';
                document.getElementById('modalCloseResult').textContent = `âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                addLog(`âŒ ëª¨ë‹¬ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // ì§€ì—° ì‹œë®¬ë ˆì´ì…˜
        function simulateDelay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì—°ê²° í…ŒìŠ¤íŠ¸
        window.onload = function() {
            if (APPS_SCRIPT_URL) {
                testConnection();
            } else {
                addLog('âš ï¸ Apps Script URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.', 'warning');
            }
        };
    </script>
</body>
</html>