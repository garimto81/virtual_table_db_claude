<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¹ ë¥¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ - ê´€ë¦¬ ëª¨ë‹¬</title>
    <script src="https://cdn-tailwindcss.vercel.app/"></script>
</head>
<body class="bg-gray-900 text-white p-4">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl font-bold mb-6 text-amber-400">ğŸ§ª ë©”ì¸ í˜ì´ì§€ ê´€ë¦¬ ê¸°ëŠ¥ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸</h1>

        <!-- ìƒíƒœ í‘œì‹œ -->
        <div class="bg-gray-800 rounded-lg p-4 mb-6">
            <h2 class="text-lg font-bold mb-2">ğŸ“Š í˜„ì¬ ìƒíƒœ</h2>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-sm text-gray-400">ë©”ì¸ í˜ì´ì§€ URL:</label>
                    <input type="text" id="mainPageUrl" value="../index.html"
                        class="w-full bg-gray-700 px-2 py-1 rounded text-sm">
                </div>
                <div>
                    <label class="text-sm text-gray-400">í…ŒìŠ¤íŠ¸ ìƒíƒœ:</label>
                    <div id="testStatus" class="text-green-400">ì¤€ë¹„ë¨</div>
                </div>
            </div>
        </div>

        <!-- ê¸°ëŠ¥ë³„ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
        <div class="bg-gray-800 rounded-lg p-4 mb-6">
            <h2 class="text-lg font-bold mb-4">âœ… ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>

            <div class="space-y-3">
                <!-- 1. ê´€ë¦¬ ëª¨ë‹¬ ì—´ê¸° -->
                <div class="flex items-center justify-between p-2 bg-gray-700 rounded">
                    <div class="flex items-center">
                        <input type="checkbox" id="test1" class="mr-3">
                        <label for="test1">1. ê´€ë¦¬ ë²„íŠ¼ í´ë¦­ â†’ ëª¨ë‹¬ ì—´ë¦¼</label>
                    </div>
                    <span class="test-result text-gray-400" id="result1">ëŒ€ê¸°</span>
                </div>

                <!-- 2. í…Œì´ë¸” ì„ íƒ -->
                <div class="flex items-center justify-between p-2 bg-gray-700 rounded">
                    <div class="flex items-center">
                        <input type="checkbox" id="test2" class="mr-3">
                        <label for="test2">2. í…Œì´ë¸” ì„ íƒ â†’ í”Œë ˆì´ì–´ ëª©ë¡ ë¡œë“œ</label>
                    </div>
                    <span class="test-result text-gray-400" id="result2">ëŒ€ê¸°</span>
                </div>

                <!-- 3. ì´ë¦„ ìˆ˜ì • -->
                <div class="flex items-center justify-between p-2 bg-gray-700 rounded">
                    <div class="flex items-center">
                        <input type="checkbox" id="test3" class="mr-3">
                        <label for="test3">3. í”Œë ˆì´ì–´ ì´ë¦„ ìˆ˜ì • (ë…¸ë€ìƒ‰ í‘œì‹œ)</label>
                    </div>
                    <span class="test-result text-gray-400" id="result3">ëŒ€ê¸°</span>
                </div>

                <!-- 4. ì¹© ìˆ˜ì • -->
                <div class="flex items-center justify-between p-2 bg-gray-700 rounded">
                    <div class="flex items-center">
                        <input type="checkbox" id="test4" class="mr-3">
                        <label for="test4">4. í”Œë ˆì´ì–´ ì¹© ìˆ˜ì • (ìŒìˆ˜ = ë¹¨ê°„ìƒ‰)</label>
                    </div>
                    <span class="test-result text-gray-400" id="result4">ëŒ€ê¸°</span>
                </div>

                <!-- 5. ì‚­ì œ -->
                <div class="flex items-center justify-between p-2 bg-gray-700 rounded">
                    <div class="flex items-center">
                        <input type="checkbox" id="test5" class="mr-3">
                        <label for="test5">5. í”Œë ˆì´ì–´ ì‚­ì œ (ì¦‰ì‹œ ì œê±°)</label>
                    </div>
                    <span class="test-result text-gray-400" id="result5">ëŒ€ê¸°</span>
                </div>

                <!-- 6. ì¶”ê°€ -->
                <div class="flex items-center justify-between p-2 bg-gray-700 rounded">
                    <div class="flex items-center">
                        <input type="checkbox" id="test6" class="mr-3">
                        <label for="test6">6. í”Œë ˆì´ì–´ ì¶”ê°€ (ëª©ë¡ì— í‘œì‹œ)</label>
                    </div>
                    <span class="test-result text-gray-400" id="result6">ëŒ€ê¸°</span>
                </div>

                <!-- 7. ì¼ê´„ ë“±ë¡ -->
                <div class="flex items-center justify-between p-2 bg-gray-700 rounded">
                    <div class="flex items-center">
                        <input type="checkbox" id="test7" class="mr-3">
                        <label for="test7">7. ì¼ê´„ ë“±ë¡ â†’ Google Sheets ë™ê¸°í™”</label>
                    </div>
                    <span class="test-result text-gray-400" id="result7">ëŒ€ê¸°</span>
                </div>

                <!-- 8. ìë™ ë‹«ê¸° -->
                <div class="flex items-center justify-between p-2 bg-gray-700 rounded">
                    <div class="flex items-center">
                        <input type="checkbox" id="test8" class="mr-3">
                        <label for="test8">8. ëª¨ë‹¬ ìë™ ë‹«ê¸° (2ì´ˆ í›„)</label>
                    </div>
                    <span class="test-result text-gray-400" id="result8">ëŒ€ê¸°</span>
                </div>

                <!-- 9. ëŒ€ì‹œë³´ë“œ ë¦¬ë‹¤ì´ë ‰íŠ¸ -->
                <div class="flex items-center justify-between p-2 bg-gray-700 rounded">
                    <div class="flex items-center">
                        <input type="checkbox" id="test9" class="mr-3">
                        <label for="test9">9. ëŒ€ì‹œë³´ë“œë¡œ ìë™ ì´ë™</label>
                    </div>
                    <span class="test-result text-gray-400" id="result9">ëŒ€ê¸°</span>
                </div>
            </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ë„êµ¬ -->
        <div class="bg-gray-800 rounded-lg p-4 mb-6">
            <h2 class="text-lg font-bold mb-4">ğŸ› ï¸ í…ŒìŠ¤íŠ¸ ë„êµ¬</h2>

            <div class="grid grid-cols-2 gap-4">
                <button onclick="openMainPage()"
                    class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">
                    ğŸ“„ ë©”ì¸ í˜ì´ì§€ ì—´ê¸°
                </button>

                <button onclick="checkManagementState()"
                    class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded">
                    ğŸ” ìƒíƒœ í™•ì¸
                </button>

                <button onclick="simulateNameChange()"
                    class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded">
                    âœï¸ ì´ë¦„ ìˆ˜ì • ì‹œë®¬ë ˆì´ì…˜
                </button>

                <button onclick="simulateChipsChange()"
                    class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded">
                    ğŸ’° ì¹© ìˆ˜ì • ì‹œë®¬ë ˆì´ì…˜
                </button>

                <button onclick="simulateDelete()"
                    class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">
                    ğŸ—‘ï¸ ì‚­ì œ ì‹œë®¬ë ˆì´ì…˜
                </button>

                <button onclick="simulateBatchUpdate()"
                    class="bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded">
                    ğŸ“¤ ì¼ê´„ ë“±ë¡ ì‹œë®¬ë ˆì´ì…˜
                </button>
            </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½ -->
        <div class="bg-gray-800 rounded-lg p-4">
            <h2 class="text-lg font-bold mb-2">ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½</h2>
            <div id="testSummary" class="space-y-2">
                <div class="text-gray-400">í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ì„¸ìš”...</div>
            </div>
        </div>

        <!-- ì½˜ì†” ë¡œê·¸ -->
        <div class="mt-6 bg-gray-800 rounded-lg p-4">
            <h2 class="text-lg font-bold mb-2">ğŸ“ í…ŒìŠ¤íŠ¸ ë¡œê·¸</h2>
            <div id="console" class="bg-black p-2 rounded h-40 overflow-y-auto font-mono text-xs">
                // ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤
            </div>
        </div>
    </div>

    <script>
        let mainWindow = null;

        // ë¡œê·¸ í•¨ìˆ˜
        function log(message, type = 'info') {
            const console = document.getElementById('console');
            const time = new Date().toLocaleTimeString();
            const color = {
                'info': '#60a5fa',
                'success': '#10b981',
                'warning': '#f59e0b',
                'error': '#ef4444'
            }[type];

            console.innerHTML += `<div style="color: ${color}">[${time}] ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }

        // ë©”ì¸ í˜ì´ì§€ ì—´ê¸°
        function openMainPage() {
            const url = document.getElementById('mainPageUrl').value;
            mainWindow = window.open(url, 'mainPage', 'width=1200,height=800');
            log('ë©”ì¸ í˜ì´ì§€ ì—´ë¦¼', 'success');

            // í˜ì´ì§€ ë¡œë“œ ëŒ€ê¸°
            setTimeout(() => {
                checkManagementState();
            }, 2000);
        }

        // ê´€ë¦¬ ìƒíƒœ í™•ì¸
        function checkManagementState() {
            if (!mainWindow) {
                log('ë©”ì¸ í˜ì´ì§€ë¥¼ ë¨¼ì € ì—´ì–´ì£¼ì„¸ìš”', 'error');
                return;
            }

            try {
                const state = mainWindow.window.managementState;
                if (state) {
                    log('ê´€ë¦¬ ìƒíƒœ í™•ì¸ë¨', 'success');
                    log(`ì„ íƒëœ í…Œì´ë¸”: ${state.selectedTable || 'ì—†ìŒ'}`, 'info');
                    log(`í”Œë ˆì´ì–´ ìˆ˜: ${state.currentPlayers ? state.currentPlayers.length : 0}`, 'info');
                    log(`ë³€ê²½ì‚¬í•­: ì¶”ê°€ ${state.changes.added.length}, ìˆ˜ì • ${state.changes.modified.length}, ì‚­ì œ ${state.changes.deleted.length}`, 'info');
                } else {
                    log('ê´€ë¦¬ ìƒíƒœê°€ ì´ˆê¸°í™”ë˜ì§€ ì•ŠìŒ', 'warning');
                }
            } catch (e) {
                log(`ì˜¤ë¥˜: ${e.message}`, 'error');
            }
        }

        // ì´ë¦„ ìˆ˜ì • ì‹œë®¬ë ˆì´ì…˜
        function simulateNameChange() {
            log('ì´ë¦„ ìˆ˜ì • ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘', 'info');
            updateTestResult(3, 'í…ŒìŠ¤íŠ¸ ì¤‘...', 'warning');

            setTimeout(() => {
                updateTestResult(3, 'âœ… ì™„ë£Œ', 'success');
                document.getElementById('test3').checked = true;
                log('ì´ë¦„ ìˆ˜ì • í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'success');
            }, 1000);
        }

        // ì¹© ìˆ˜ì • ì‹œë®¬ë ˆì´ì…˜
        function simulateChipsChange() {
            log('ì¹© ìˆ˜ì • ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘', 'info');
            updateTestResult(4, 'í…ŒìŠ¤íŠ¸ ì¤‘...', 'warning');

            setTimeout(() => {
                updateTestResult(4, 'âœ… ì™„ë£Œ', 'success');
                document.getElementById('test4').checked = true;
                log('ì¹© ìˆ˜ì • í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'success');
            }, 1000);
        }

        // ì‚­ì œ ì‹œë®¬ë ˆì´ì…˜
        function simulateDelete() {
            log('ì‚­ì œ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘', 'info');
            updateTestResult(5, 'í…ŒìŠ¤íŠ¸ ì¤‘...', 'warning');

            setTimeout(() => {
                updateTestResult(5, 'âœ… ì™„ë£Œ', 'success');
                document.getElementById('test5').checked = true;
                log('ì‚­ì œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'success');
            }, 1000);
        }

        // ì¼ê´„ ë“±ë¡ ì‹œë®¬ë ˆì´ì…˜
        function simulateBatchUpdate() {
            log('ì¼ê´„ ë“±ë¡ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘', 'info');
            updateTestResult(7, 'ì²˜ë¦¬ ì¤‘...', 'warning');

            // ëª¨ë‹¬ ìë™ ë‹«ê¸° í…ŒìŠ¤íŠ¸
            setTimeout(() => {
                updateTestResult(7, 'âœ… ì™„ë£Œ', 'success');
                document.getElementById('test7').checked = true;
                log('ì¼ê´„ ë“±ë¡ ì™„ë£Œ', 'success');

                // ìë™ ë‹«ê¸° í…ŒìŠ¤íŠ¸
                updateTestResult(8, 'ëŒ€ê¸° ì¤‘...', 'warning');
                setTimeout(() => {
                    updateTestResult(8, 'âœ… ì™„ë£Œ', 'success');
                    document.getElementById('test8').checked = true;
                    log('ëª¨ë‹¬ ìë™ ë‹«ê¸° ì™„ë£Œ', 'success');

                    // ë¦¬ë‹¤ì´ë ‰íŠ¸ í…ŒìŠ¤íŠ¸
                    updateTestResult(9, 'âœ… ì™„ë£Œ', 'success');
                    document.getElementById('test9').checked = true;
                    log('ëŒ€ì‹œë³´ë“œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì™„ë£Œ', 'success');

                    updateSummary();
                }, 2000);
            }, 1000);
        }

        // í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì—…ë°ì´íŠ¸
        function updateTestResult(testNum, text, type) {
            const result = document.getElementById(`result${testNum}`);
            result.textContent = text;
            result.className = `test-result ${
                type === 'success' ? 'text-green-400' :
                type === 'warning' ? 'text-yellow-400' :
                type === 'error' ? 'text-red-400' :
                'text-gray-400'
            }`;
        }

        // ìš”ì•½ ì—…ë°ì´íŠ¸
        function updateSummary() {
            const total = 9;
            const checked = document.querySelectorAll('input[type="checkbox"]:checked').length;
            const percentage = Math.round((checked / total) * 100);

            document.getElementById('testSummary').innerHTML = `
                <div class="flex items-center justify-between">
                    <span>ì™„ë£Œëœ í…ŒìŠ¤íŠ¸: ${checked} / ${total}</span>
                    <span class="text-2xl">${percentage}%</span>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-2">
                    <div class="bg-green-500 h-2 rounded-full" style="width: ${percentage}%"></div>
                </div>
                ${checked === total ? '<div class="text-green-400 font-bold mt-2">âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ ì™„ë£Œ!</div>' : ''}
            `;
        }

        // ì²´í¬ë°•ìŠ¤ ë³€ê²½ ê°ì§€
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', updateSummary);
        });

        // ì´ˆê¸°í™”
        log('í…ŒìŠ¤íŠ¸ í™˜ê²½ ì¤€ë¹„ ì™„ë£Œ', 'success');
    </script>
</body>
</html>