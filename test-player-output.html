<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLAYER ì¶œë ¥ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: monospace; background: #1a1a1a; color: white; padding: 20px; }
        .test-case { background: #333; border-radius: 8px; padding: 15px; margin: 20px 0; }
        h3 { color: #fbbf24; }
        table { border-collapse: collapse; width: 100%; margin: 10px 0; }
        td, th { border: 1px solid #555; padding: 8px; text-align: left; }
        th { background-color: #444; color: #fbbf24; }
        .expected { background-color: #1a4d1a; }
        .actual { background-color: #1a1a4d; }
        .error { background-color: #4d1a1a; }
        button { background: #4b5563; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #6b7280; }
        pre { background: #222; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ¯ PLAYER í–‰ ì¶œë ¥ í˜•ì‹ í…ŒìŠ¤íŠ¸</h1>
    
    <div class="test-case">
        <h3>ì˜ˆìƒ í˜•ì‹ (ì˜¬ë°”ë¥¸ í˜•ì‹)</h3>
        <table>
            <tr>
                <th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th>
            </tr>
            <tr class="expected">
                <td>4</td>
                <td>PLAYER</td>
                <td>LEMMENS</td>
                <td>1</td>
                <td>0</td>
                <td>575000</td>
                <td>0</td>
                <td>7h 7d</td>
            </tr>
            <tr class="expected">
                <td>5</td>
                <td>PLAYER</td>
                <td>CALONGE</td>
                <td>2</td>
                <td>0</td>
                <td>998000</td>
                <td>358000</td>
                <td>Qh Jh</td>
            </tr>
        </table>
        <p style="color: #10b981;">âœ… í˜•ì‹: í–‰ë²ˆí˜¸ | PLAYER | ì´ë¦„ | ì¢Œì„ | 0 | ì‹œì‘ì¹© | ì¢…ë£Œì¹© | í•¸ë“œ</p>
    </div>
    
    <div class="test-case">
        <h3>í˜„ì¬ ì˜ëª»ëœ ì¶œë ¥ (ë¬¸ì œ ìƒí™©)</h3>
        <table>
            <tr>
                <th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th><th>I</th>
            </tr>
            <tr class="error">
                <td>4</td>
                <td>PLAYER</td>
                <td>Jaewon</td>
                <td>1</td>
                <td>0</td>
                <td style="background: red;">0</td>
                <td>134000</td>
                <td>994000</td>
                <td>3h 3d</td>
            </tr>
            <tr class="error">
                <td>5</td>
                <td>PLAYER</td>
                <td>Trey</td>
                <td>2</td>
                <td>0</td>
                <td style="background: red;">0</td>
                <td>370000</td>
                <td>374000</td>
                <td>4s 4h</td>
            </tr>
        </table>
        <p style="color: #ef4444;">âŒ ì¹¼ëŸ¼ì´ í•˜ë‚˜ ë” ë§ìŒ (ë¹¨ê°„ìƒ‰ ë¶€ë¶„ì´ ì¶”ê°€ë¨)</p>
    </div>
    
    <div class="test-case">
        <h3>ì½”ë“œ ì‹œë®¬ë ˆì´ì…˜</h3>
        <button onclick="testPlayerGeneration()">PLAYER ìƒì„± í…ŒìŠ¤íŠ¸</button>
        <div id="output"></div>
    </div>
    
    <script>
        function unformatNumber(str) {
            if (!str) return '';
            return String(str).replace(/,/g, '');
        }
        
        function testPlayerGeneration() {
            const output = document.getElementById('output');
            let html = '<h4>í…ŒìŠ¤íŠ¸ ì‹¤í–‰:</h4>';
            
            // ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°
            const state = {
                playersInHand: [
                    { name: 'Jaewon', chips: '994,000', initialChips: '134,000', hand: ['3h', '3d'] },
                    { name: 'Trey', chips: '374,000', initialChips: '370,000', hand: ['4s', '4h'] }
                ]
            };
            
            // generateRows_v46 ì‹œë®¬ë ˆì´ì…˜
            const out = [];
            let no = 4; // 4ë²ˆ í–‰ë¶€í„° ì‹œì‘
            const push = (arr) => {
                const a = [no, ...arr];
                while(a.length < 18) a.push('');
                out.push(a);
                no++;
            };
            
            // PLAYERS ìƒì„±
            const players = state.playersInHand.map((p, i) => ({...p, seat: i + 1}));
            
            html += '<h4>1. í”Œë ˆì´ì–´ ë°ì´í„°:</h4>';
            html += '<pre>' + JSON.stringify(players, null, 2) + '</pre>';
            
            players.forEach(p => {
                // í˜„ì¬ ì½”ë“œì˜ ë¬¸ì œì  í™•ì¸
                let initialChips = parseInt(unformatNumber(p.initialChips) || 0, 10);
                let finalChips = parseInt(unformatNumber(p.chips) || 0, 10);
                
                html += `<h5>${p.name}:</h5>`;
                html += `<p>initialChips: "${p.initialChips}" â†’ ${initialChips}</p>`;
                html += `<p>finalChips (chips): "${p.chips}" â†’ ${finalChips}</p>`;
                
                // ë¬¸ì œ: initialChipsì™€ finalChipsì˜ ìˆœì„œê°€ ë°”ë€Œì–´ ìˆì„ ê°€ëŠ¥ì„±
                // ì›ë˜: ì‹œì‘ì¹©ì´ ë¨¼ì €, ì¢…ë£Œì¹©ì´ ë‚˜ì¤‘
                // í˜„ì¬: ë‘˜ì˜ ìˆœì„œê°€ ë°”ë€Œì—ˆì„ ìˆ˜ ìˆìŒ
                
                const playerRow = ['PLAYER', p.name, p.seat, 0, initialChips, finalChips, p.hand?.length ? p.hand.join(' ') : ''];
                html += `<p>ìƒì„±ëœ ë°°ì—´: [${playerRow.join(', ')}]</p>`;
                push(playerRow);
            });
            
            html += '<h4>2. ìµœì¢… ì¶œë ¥:</h4>';
            html += '<table>';
            html += '<tr><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th></tr>';
            
            out.forEach(row => {
                html += '<tr class="actual">';
                row.slice(0, 8).forEach((cell, idx) => {
                    // Eì—´(ì¸ë±ìŠ¤ 4)ê³¼ Fì—´(ì¸ë±ìŠ¤ 5)ì´ ì¹© ê°’
                    const highlight = (idx === 5 || idx === 6) ? 'style="background: #444;"' : '';
                    html += `<td ${highlight}>${cell}</td>`;
                });
                html += '</tr>';
            });
            html += '</table>';
            
            // ë¶„ì„
            html += '<h4>3. ë¬¸ì œ ë¶„ì„:</h4>';
            if(out[0] && out[0].length > 8) {
                html += '<p style="color: #ef4444;">âŒ ì¹¼ëŸ¼ì´ 8ê°œë³´ë‹¤ ë§ìŒ: ' + out[0].length + 'ê°œ</p>';
            }
            
            // ì˜¬ë°”ë¥¸ ê°’ í™•ì¸
            const firstRow = out[0];
            if(firstRow) {
                const actualInitial = firstRow[5];  // Fì—´
                const actualFinal = firstRow[6];     // Gì—´
                
                html += '<p>Fì—´ (ì‹œì‘ì¹©ì´ì–´ì•¼ í•¨): ' + actualInitial + '</p>';
                html += '<p>Gì—´ (ì¢…ë£Œì¹©ì´ì–´ì•¼ í•¨): ' + actualFinal + '</p>';
                
                if(actualInitial === 134000 && actualFinal === 994000) {
                    html += '<p style="color: #10b981;">âœ… ê°’ì€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë¨</p>';
                } else if(actualInitial === 994000 && actualFinal === 134000) {
                    html += '<p style="color: #ef4444;">âŒ ì‹œì‘ì¹©ê³¼ ì¢…ë£Œì¹©ì´ ë°”ë€Œì–´ ìˆìŒ!</p>';
                } else {
                    html += '<p style="color: #ef4444;">âŒ ê°’ì´ ì˜ˆìƒê³¼ ë‹¤ë¦„</p>';
                }
            }
            
            output.innerHTML = html;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
        window.onload = testPlayerGeneration;
    </script>
</body>
</html>